"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1221],{3905:function(e,t,a){a.d(t,{Zo:function(){return m},kt:function(){return h}});var n=a(7294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var l=n.createContext({}),c=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},m=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),d=c(a),h=i,p=d["".concat(l,".").concat(h)]||d[h]||u[h]||r;return a?n.createElement(p,o(o({ref:t},m),{},{components:a})):n.createElement(p,o({ref:t},m))}));function h(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,o=new Array(r);o[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var c=2;c<r;c++)o[c]=a[c];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},2159:function(e,t,a){a.r(t),a.d(t,{contentTitle:function(){return l},default:function(){return d},frontMatter:function(){return s},metadata:function(){return c},toc:function(){return m}});var n=a(7462),i=a(3366),r=(a(7294),a(3905)),o=["components"],s={id:"Wasm_Operation_Principle",title:"WebAssembly(Wasm)",sidebar_label:"WebAssembly(Wasm)"},l=void 0,c={unversionedId:"Wasm_Operation_Principle",id:"Wasm_Operation_Principle",isDocsHomePage:!1,title:"WebAssembly(Wasm)",description:"Preface",source:"@site/../docs/WASM\u865a\u62df\u673a.md",sourceDirName:".",slug:"/Wasm_Operation_Principle",permalink:"/docs/en/Wasm_Operation_Principle",editUrl:"https://github.com/PlatONnetwork/docs/tree/master/docs/WASM\u865a\u62df\u673a.md",version:"current",frontMatter:{id:"Wasm_Operation_Principle",title:"WebAssembly(Wasm)",sidebar_label:"WebAssembly(Wasm)"},sidebar:"docs",previous:{title:"Governance mechanism",permalink:"/docs/en/PlatON_Governance_Solution"},next:{title:"Intro to validator",permalink:"/docs/en/PlatON_Validation_Introduce"}},m=[{value:"Preface",id:"preface",children:[]},{value:"Introduction of WASM",id:"introduction-of-wasm",children:[]},{value:"Advantages of PlatON to Introduce WASM",id:"advantages-of-platon-to-introduce-wasm",children:[]},{value:"The Operating Mechanism of WASM",id:"the-operating-mechanism-of-wasm",children:[]},{value:"Summary",id:"summary",children:[]}],u={toc:m};function d(e){var t=e.components,a=(0,i.Z)(e,o);return(0,r.kt)("wrapper",(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"preface"},"Preface"),(0,r.kt)("p",null,"WASM (WebAssembly) is not a language, but a new bytecode format, a brand-new underlying binary grammar, and instruction code compiled by the compiler. Small in size, portable, fast in loading, and compatible with the latest format of the Web, WASM is a new technology to run portable programs safely and effectively. This article analyzes the introduction, advantages, operation mechanism and use of the PlatON WASM contract in detail."),(0,r.kt)("h2",{id:"introduction-of-wasm"},"Introduction of WASM"),(0,r.kt)("p",null,"WASM was mainly applied on the Web in the early days. As it continues to develop, it is used as the final format of smart contracts by increasing projects, and runs with the corresponding VM loaded, such as wavm and wagon. Bytecodes are parsed and operate in the core virtual machine module. "),(0,r.kt)("p",null,"The virtual machine (VM) refers to a complete computer system that is simulated by software, has functions of a complete hardware system and runs in an isolated environment, such as the Vmware virtual machine for operating system virtualization and the JVM virtual machine for the software operating environment. The virtual machine in the blockchain is a code operating environment built on the blockchain, mainly to process the smart contracts of the blockchain."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Why does PlatON introduce the WASM virtual machine as a supplement to the EVM?")," "),(0,r.kt)("p",null,"As the demand for virtual machines and smart contracts in blockchain applications grows, the blockchain virtual machine technology is being improved as time goes by. At present, WASM-based virtual machines have been significantly improved in terms of speed and performance, and support multiple high-level development languages such as C, C++, Rust, and Golang, lowering the development threshold. "),(0,r.kt)("p",null,"To facilitate the development of blockchain applications, PlatON has launched a dual virtual machine engine that supports the WASM virtual machine and the EVM at the same time. Blockchain applications that originally run on public chains that support EVM, such as Ethereum, can migrate easily and seamlessly if they need to use PlatON due to performance and other reasons. "),(0,r.kt)("p",null,"EVM is essentially a script program, a stack-based virtual machine, which needs to be executed after being translated into instructions by a compiler, which is quite inefficient. At the same time, EVM also has some problems in its architecture and use, such as: "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"Strong coupling and difficult scalability"),": The chain and the EVM are internally dependent upon each other;"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"Lack of a standard library"),": There is basically no standard library in solidity, and you must independently code corresponding functions, such as string comparison.")),(0,r.kt)("p",null,"Compared with EVM, WASM, as a kind of intermediate code, runs smart contracts faster, and can be developed in any familiar programming language (C/C++/Rust/Golang). It also has many other features:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"Efficient performance"),": Binary coding adopted has superior performance during program execution;"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"Support by multiple languages"),": You can use C/C++/Rust/Golang and other languages to write the contract and then compile the contract into bytecode;"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"Abundant standard libraries"),": There are abundant standard libraries available for use in different languages.")),(0,r.kt)("p",null,"At the same time, WASM has been applied by a growing number of projects, including Ethereum that has introduced the EVM. The popularity of WASM has driven its community ecosystem to improve."),(0,r.kt)("p",null,"In order to adapt the existing WASM applications and developers familiar with WASM to the PlatON ecosystem, PlatON decided after comprehensive consideration to adopt dual virtual machines, that is, to introduce the WASM virtual machine as a supplement to the EVM."),(0,r.kt)("h2",{id:"advantages-of-platon-to-introduce-wasm"},"Advantages of PlatON to Introduce WASM"),(0,r.kt)("p",null,"PlatON factored in some of the disadvantages of the EVM upon its decision to introduce the virtual machine. Right after the EVM was introduced, PlatON began the design and development of the WASM virtual machine, and kept making innovations and improvements in terms of scalability, stability, and operating efficiency. The main functions include:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"With a complete set of contract development kit ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/PlatONnetwork/PlatON-CDT"},"PlatON-CDT"),";"),(0,r.kt)("li",{parentName:"ul"},"Smaller contract bytecode. WASM binary code compiled by CDT suite is half smaller compared with other projects;"),(0,r.kt)("li",{parentName:"ul"},"With a smart contract framework ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/PlatONnetwork/platon-truffle"},"PlatON-Truffle")," for rapid development;"),(0,r.kt)("li",{parentName:"ul"},"With support for string, address, hash, u128 and other data types;"),(0,r.kt)("li",{parentName:"ul"},"The gas mechanism introduced. Every time a contract instruction is executed, the corresponding gas will be deducted to ensure that the execution of the contract instruction can be terminated after a limited number of operations, thereby effectively preventing code from attacks of the infinite loop;"),(0,r.kt)("li",{parentName:"ul"},"Contract nested call introduced, which can immediately obtain the result of another contract call, making calls between contracts as convenient as function calls;"),(0,r.kt)("li",{parentName:"ul"},"With support for the automatic expansion of linear memory and caching WASM module to optimize the loading performance of the contract, thereby greatly improving the operating performance of the virtual machine.")),(0,r.kt)("p",null,"Based on the application and optimization of WASM, PlatON's smart contract module boasts higher compatibility and performance, as well as better security and flexibility. After successfully integrating WASM and applying dual virtual machines, PlatON tested the performance of the EVM and WASM for comparison under the same environment."),(0,r.kt)("p",null,"The test results show that the execution efficiency of the WASM virtual machine is much higher than that of the EVM. EVM uses 256-bit machine code that greatly affects the performance of the execution and at the same time increases the memory usage."),(0,r.kt)("p",null,"PlatON has the following advantages after introducing the WASM virtual machine as part of the dual virtual machines:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Mainstream WASM smart contracts can be easily and quickly migrated to the PlatON network;")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"The threshold for contract developers is lowered, with little learning cost;")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Developers who use other WASM-based networks can be well-adapted to the WASM virtual machine and get started quickly;")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"The execution of smart contracts is more efficient;")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Abundant development libraries can improve the efficiency of smart contract development."))),(0,r.kt)("h2",{id:"the-operating-mechanism-of-wasm"},"The Operating Mechanism of WASM"),(0,r.kt)("p",null,"The WASM virtual machine is a completely independent sandbox. Fully isolated from the outside, the contract code runs inside the virtual machine, and cannot access the network, file system or other processes. At the same time, to prevent the virtual machine from executing too many computation instructions and falling into an infinite loop, both the gas mechanism and the timeout mechanism are introduced as dual controls."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"The working principle of dual virtual machines:")),(0,r.kt)("img",{src:"/docs/img/en/Wasm.assets/wasm-dual.png"}),(0,r.kt)("p",null,"As shown in the figure: Smart contracts written in languages such as solidity/c/c++ are compiled into bytecode by a compiler. At the same time, different types of contracts come with different bytecode features. By recognizing the features, the engine of the dual virtual machines of PlatON can select a specific virtual machine to load the bytecode, parse it, and then execute the corresponding function according to the instruction."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Usage process of the smart contract:")),(0,r.kt)("img",{src:"/docs/img/en/Wasm.assets/wasm-contract.webp"}),(0,r.kt)("p",null,"As shown in the figure, you can use C++ to write a smart contract based on WASM, or solidity to write a smart contract that belongs to the EVM, then compile and generate bytecode and other information through the toolset, and then send it to a node on the PlatON network by the transaction through the SDK development toolset. That is a complete process of a contract-related transaction."),(0,r.kt)("p",null,"PlatON provides a complete WASM contract development kit named PlatON-CDT. Using this kit, you can quickly write smart contracts for the WASM virtual machine. The kit encapsulates various types of data, and is equipped with a simple API interface and detailed interface documentation. At the same time, you can also use the smart contract testing framework PlatON-Truffle for development, compilation, deployment, contract interface testing and other functions, which is convenient for developers to develop and test contracts."),(0,r.kt)("p",null,"PlatON provides an automated ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/PlatONnetwork/client-sdk-java"},"Contract SDK")," generation tool, which can automatically generate the code for the back-end system to call the contract interface and can shield the parameter encoding and decoding details when calling the contract. In this way, it helps developers quickly integrate contract business into the system, so that they can be more focused on developing the business logic of smart contracts."),(0,r.kt)("h2",{id:"summary"},"Summary"),(0,r.kt)("p",null,"This article mainly discusses the background and original intention of PlatON to support the WASM virtual machine and introduces the unique advantages brought by the introduction of WASM. It also briefly explains the basic principles and operating mechanisms of the WASM virtual machine. With this article, the author hopes to provide some useful experience for community users, developers, and blockchain professionals participating in PlatON. From a bust to a boom, WASM will be applied in increasing projects as the underlying level of distributed application development in the future."))}d.isMDXComponent=!0}}]);