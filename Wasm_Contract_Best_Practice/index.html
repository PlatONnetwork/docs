<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.3">
<link rel="search" type="application/opensearchdescription+xml" title="PlatON" href="/docs/opensearch.xml">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script src="https://cdn.jsdelivr.net/npm/mermaid@8.4.0/dist/mermaid.min.js"></script>
<script src="/docs/js/custom.js"></script><title data-react-helmet="true">Best practices | PlatON</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://luo-dahui.github.io//docs/Wasm_Contract_Best_Practice"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Best practices | PlatON"><meta data-react-helmet="true" name="description" content="Introduction"><meta data-react-helmet="true" property="og:description" content="Introduction"><meta data-react-helmet="true" property="og:image" content="https://luo-dahui.github.io//docs/img/undraw_online.svg"><meta data-react-helmet="true" name="twitter:image" content="https://luo-dahui.github.io//docs/img/undraw_online.svg"><link data-react-helmet="true" rel="shortcut icon" href="/docs/img/logo.png"><link data-react-helmet="true" rel="canonical" href="https://luo-dahui.github.io//docs/Wasm_Contract_Best_Practice"><link data-react-helmet="true" rel="alternate" href="https://luo-dahui.github.io//docs/Wasm_Contract_Best_Practice" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://luo-dahui.github.io//docs/zh-CN/Wasm_Contract_Best_Practice" hreflang="zh-CN"><link data-react-helmet="true" rel="alternate" href="https://luo-dahui.github.io//docs/Wasm_Contract_Best_Practice" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/docs/assets/css/styles.9355613d.css">
<link rel="preload" href="/docs/assets/js/runtime~main.04d2f2cd.js" as="script">
<link rel="preload" href="/docs/assets/js/main.16343a54.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><img src="/docs/img/PlatON-logo.svg" alt="PlatON" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/docs/img/PlatON-logo.svg" alt="PlatON" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"></a></div><div class="navbar__items navbar__items--right"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__item navbar__link"><span>English</span></a><ul class="dropdown__menu"><li><a href="/docs/Wasm_Contract_Best_Practice" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">English</a></li><li><a href="/docs/Wasm_Contract_Best_Practice" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">中文</a></li></ul></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/docs/"><img src="/docs/img/PlatON-logo.svg" alt="PlatON" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/docs/img/PlatON-logo.svg" alt="PlatON" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a href="#" role="button" class="menu__link menu__link--sublist"><span>Languages</span></a><ul class="menu__list"><li class="menu__list-item"><a href="/docs/Wasm_Contract_Best_Practice" target="_self" rel="noopener noreferrer" class="menu__link dropdown__link--active" style="text-transform:capitalize">English</a></li><li class="menu__list-item"><a href="/docs/Wasm_Contract_Best_Practice" target="_self" rel="noopener noreferrer" class="menu__link" style="text-transform:capitalize">中文</a></li></ul></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_lDyR"><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu menu--responsive thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_iZzd" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Basics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/lat_introduced">Intro to LAT</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/staking_and_delegation">Staking&amp;Delegation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Network_Description">Networks</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Advanced</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/PlatON_Overall_Solution">Architecture</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Economic_Model">Economic model</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/PlatON_Solution">PlatON Consensus Solution</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/PlatON_Governance_Solution">Governance mechanism</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Wasm_Operation_Principle">WebAssembly(Wasm)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">PlatON Node</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/PlatON_Validation_Introduce">Intro to validator</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Become_PlatON_Main_Verification">Run a validator node</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="-1">Tools for nodes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/OnLine_MTool_Manual">MTool online tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/OffLine_MTool_Manual">MTool offline tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Command_Line_Tools">Command line tools</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/CTool_Manual">CTool tutorial</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Developers</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/PlatON_Overview_DevGuide">Development guide</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Set up local environment</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Join_Dev_Network">Dev Network</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Build_Private_Chain">Private Network</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Smart contract</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">System contract</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/PlatON_system_contract">System contracts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/PlatON_system_contract_api">System contract api</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Solidity contract</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Solidity_Dev_Manual">Getting started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Solidity_Contract_Migrate">Migration tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Solidity_Contract_Dev_Costs">Development costs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Solidity_Contract_Best_Practice">Best practices</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Solidity_Contract_Security_Dev_Guide">Contract security</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Solidity_Inner_Contract">Call Inner Contract</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Wasm contract</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Wasm_Dev_Manual">Getting started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Wasm_Contract_Dev_Costs">Development Costs</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/Wasm_Contract_Best_Practice">Best practices</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Wasm_Contract_API">Wasm API</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">References</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Python_SDK">Python SDK</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/JS_SDK">JS SDK</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Java_SDK">Java SDK</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Go_SDK">Go SDK</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/NET_SDK">.NET SDK</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Json_Rpc">JSON-RPC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/GraphQL_Server">GraphQL Server</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Explorer_API">Explorer API</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Samurai_API">Samurai API</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">PRC Token</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/PRC20_contract">PRC-20</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/PRC721_contract">PRC-721</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Data and analytics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/PlatON_BlockChain_Browser">PlatScan</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/PlatEye">PlatEye</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tutorials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/DApp_migrate">DApp Quick Migration Tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/qianqian_prc721_tutorial">PRC721 NFT Release Tutorial</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="-1">WASM Tutorials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/WASM_Contract_1">WASM—Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/WASM_Contract_2">WASM—Cross contracts Interaction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/WASM_Contract_3">WASM—Contract Event</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/WASM_Contract_4">WASM—Parameters</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/WASM_Contract_5">WASM—Proxy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/WASM_Contract_6">WASM—Proxy Event</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/WASM_Contract_7">WASM—General Proxy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/WASM_Contract_8">WASM—Build-in Type</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/WASM_Contract_9">WASM—Build-in Type Performance Test</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="-1">WalletConnect</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/walletconnect_tutorial">WalletConnect</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/DApp_integration_with_WalletConnect_for_ATON">WalletConnect integration Tutorial</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/get_vrf_random_number">Get a Random Number</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adapting_to_new_chainid">Adapting to new chainid</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/eip55-bech32-compatible">EIP55 and Bech32 address</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Wallet</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ATON-user-manual">ATON Wallet User Manual</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Samurai_user_manual">Samurai</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Third_Party_Walle">Third-party wallets</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Ledger-hardware-wallet">Ledger hardware wallet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/MetaMask">MetaMask</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/community">Community Projects</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="markdown"><header><h1 class="h1Heading_dC7a">Best practices</h1></header><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="introduction"></a>Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">#</a></h3><p>This guide introduces users to some key points that need to be paid attention to
in the development of smart contracts, mainly in the practice of actual
development. Users can use this guide to quickly understand how to set a
reasonable fee for a transaction, how to avoid losing the fee due to transaction
failure, and how to encode a more standardized smart contract.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="reasonable-cost-setting"></a>Reasonable Cost Setting<a class="hash-link" href="#reasonable-cost-setting" title="Direct link to heading">#</a></h3><p>When you need to deploy a contract on the main network of PlatON, you need to set a reasonable fee limit. The fee limit refers to the upper limit of the energy consumption cost of smart contract deployment/execution in PlatON. This restriction is mainly accomplished through Gas. Gas is the fuel value of the PlatON network world, which determines the normal operation of the PlatON network ecosystem. Gas is usually used to measure how much “work” is required to perform certain actions, and these workloads are the amount of fees that need to be paid to the PlatON network in order to perform the action. In a simple understanding, Gas is the commission for network miners, and is paid by LAT. Any transaction, contract execution, and data storage on the network need to use Gas.</p><p>PlatON is similar to Ethereum’s blockchain system. It uses <code>LAT</code> for payment and
maintenance networks. One <code>LAT</code> is divided into: <code>mLAT/uLAT/gVON/mVON/kVON/VON</code>, and <code>VON</code> is the smallest unit.</p><p>Gas consists of two parts: GasLimit and GasPrice. GasLimit is the maximum Gas consumption (minimum 21,000) that a user is willing to pay to perform an operation or confirm a transaction. GasPrice is the unit price of each Gas.</p><p>When a user sends a transaction, GasLimit and GasPrice are set. GasLimit * GasPrice is the user’s transaction cost, and the cost is rewarded to the miner as a commission.</p><p>The higher the GasPrice of the transaction, the higher the execution priority of the transaction and the greater the transaction cost. After each transaction is completed, the remaining unused Gas will be returned to the sender’s address account. It is important to note that if the execution of the transaction fails because the GasLimit is set too low, the Gas will not be returned to the user’s address at this time, and the user still needs to pay the energy cost for the failed transaction. Therefore, regardless of whether the transaction is executed successfully, the transaction sender needs to pay a certain calculation fee to the miner.</p><p><strong>LAT Unit Conversion</strong></p><table><thead><tr><th>Unit</th><th>VON Value</th><th>VON</th></tr></thead><tbody><tr><td>VON</td><td>1</td><td>1</td></tr><tr><td>kVON</td><td>1e3 VON</td><td>1,000</td></tr><tr><td>mVON</td><td>1e6 VON</td><td>1,000,000</td></tr><tr><td>gVON</td><td>1e9 VON</td><td>1,000,000,000</td></tr><tr><td>microLAT</td><td>1e12 VON</td><td>1,000,000,000,000</td></tr><tr><td>milliLAT</td><td>1e15 VON</td><td>1,000,000,000,000,000</td></tr><tr><td>LAT</td><td>1e18 VON</td><td>1,000,000,000,000,000,000</td></tr><tr><td>kLAT</td><td>1e21 VON</td><td>1,000,000,000,000,000,000,000</td></tr><tr><td>mLAT</td><td>1e24 VON</td><td>1,000,000,000,000,000,000,000,000</td></tr><tr><td>gLAT</td><td>1e27 VON</td><td>1,000,000,000,000,000,000,000,000,000</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="avoid-timeouts"></a>Avoid Timeouts<a class="hash-link" href="#avoid-timeouts" title="Direct link to heading">#</a></h3><p>Sending transactions on the PlatON network does not have the concept of timeout, but it will eventually stop according to the set gas limit value. If the limit value is lower than the consumption required for contract deployment, the transaction execution fails and the corresponding processing fee will be deducted. The fee setting cannot be infinite, because in the network, the block itself has a maximum GasLimit value. When the GasLimit of the transaction exceeds this value, the transaction will not be accepted.</p><p>If the call function of a published contract is called (a call is a stateless operation in the contract logic), there is a 5s timeout limit. If the contract logic is not executed within 5s, a timeout will occur and the virtual machine will forcely exit , causing the query to fail.</p><p>To avoid contract-related transaction failures, try breaking large contracts into smaller pieces and referencing each other as needed. To avoid infinite loops, be aware of common pitfalls and recursive calls.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="punishment-for-illegal-operations"></a>Punishment For Illegal Operations<a class="hash-link" href="#punishment-for-illegal-operations" title="Direct link to heading">#</a></h3><p>If the smart contract is not compiled by a standard valid compiler, or the instruction code is changed at will, the opcode will be invalid. This type of contract not only fails to be deployed and executed successfully, but also generates a full amount (GasLimit * GasPrice) penalty. The transaction fee for the current transaction will be deducted. This is a very strong penalty. If the operator does not pay attention to this point and keep retrying, then the cost will be higher and the cost will be heavier.</p><p>In general, invalid opcodes have the following conditions:</p><ul><li>Manually changed the instruction code for the normally compiled contract</li><li>The contract compiler version is not consistent with the contract version
supported by the network lock</li><li>Use float type to do operation</li></ul><p>When operating a contract in the PlatON network. First, you must confirm the smart contract version supported by the current network, and then select the compiler of the corresponding version pair.</p><p>The normal operation is to use the latest Truffle/PlatON-CDT officially provided by PlatON to compile/deploy/execute the contract. At the same time, before switching to the main network, it must be validated on the test network.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="cc-language-limit"></a>C/C++ Language Limit<a class="hash-link" href="#cc-language-limit" title="Direct link to heading">#</a></h3><p><strong>C/C++ features not supported</strong></p><ul><li>float type(float/double)</li><li>typeid/dynamic_cast(-fno-rtti)</li><li>try-catch(-fno-exception)</li><li>features after C++17</li></ul><p><strong>libc not supported header files</strong></p><ul><li>signal.h</li><li>math.h</li><li>locale.h</li><li>errno.h</li><li>uchar.h</li><li>time.h</li></ul><p><strong>libc++ not suppported header files</strong></p><ul><li>rand</li><li>atomics</li><li>thread</li><li>random</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="coding-standards"></a>Coding Standards<a class="hash-link" href="#coding-standards" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="naming-rules"></a>Naming rules<a class="hash-link" href="#naming-rules" title="Direct link to heading">#</a></h4><ul><li><p>The style of a name immediately informs us what sort of thing the named entity
is: a type, a variable, a function, a constant, a macro, etc.</p></li><li><p>Use terminology within the blockchain industry.</p></li><li><p>Use as few abbreviations as possible. If you must use them, it is recommended
to use public abbreviations and custom abbreviations.</p></li><li><p>Filenames should be all lowercase and can include underscores (_) or dashes
(-).</p></li><li><p>For smart contracts, the file name is consistent with the contract name.</p></li><li><p>Type names start with a capital letter and have a capital letter for each new
word, with no underscores: <code>MyExcitingClass</code>, <code>MyExcitingEnum</code>.</p></li><li><p>The names of variables (including function parameters) and data members are
all lowercase, with underscores between words. Data members of classes (but
not structs) additionally have trailing underscores. For instance:
<code>a_local_variable</code>, <code>a_struct_data_member</code>, <code>a_class_data_member_</code>.</p></li><li><p>Variables declared constexpr or const, and whose value is fixed for the
duration of the program, are named with a leading &quot;k&quot; followed by mixed case.
Underscores can be used as separators in the rare cases where capitalization
cannot be used for separation. For example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI cpp"><pre tabindex="0" class="prism-code language-cpp codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">int</span><span class="token plain"> kDaysInAWeek </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">7</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li><p>Regular functions have mixed case; accessors and mutators may be named like
variables: <code>MyExcitingFunction()</code>, <code>MyExcitingMethod()</code>,
<code>my_exciting_member_variable()</code>, <code>set_my_exciting_member_variable()</code></p></li><li><p>Enumerators (for both scoped and unscoped enums) should be named either like
constants or like macros: either <code>kEnumName</code> or <code>ENUM_NAME</code>.</p></li><li><p>If you are naming something that is analogous to an existing C or C++ entity
then you can follow the existing naming convention scheme.</p></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="document-format-for-smart-contracts"></a>Document Format For Smart Contracts<a class="hash-link" href="#document-format-for-smart-contracts" title="Direct link to heading">#</a></h4><p>File Layout Rules:</p><ul><li>Generally more than 1000 lines of program code is difficult to read, try to
avoid the situation that the number of lines of code in a file is too long.
Each contract document should contain only a single contract class or contract
interface.</li></ul><p>Order Of Files:</p><ul><li>Notes on files: All contract source files have a note at the beginning, which
lists the copyright statement, file name, function description, and creation
and modification records of the file.</li><li>Remarks for class or interface: Comments should be made before class and
interface definitions, including descriptions of classes and interfaces,
latest modifiers, version numbers, reference links, etc.</li><li>The order of class member: first the public level, then the protection
level, and finally the private level.</li><li>Member functions: Functions within a contract should be grouped by module, not by
scope or access permissions.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="feature-uses-advice"></a>Feature Uses Advice<a class="hash-link" href="#feature-uses-advice" title="Direct link to heading">#</a></h4><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="structs-vs-classes"></a>Structs vs Classes<a class="hash-link" href="#structs-vs-classes" title="Direct link to heading">#</a></h5><p>Use a struct only for passive objects that carry data; everything else is a
class.</p><p>The struct and class keywords behave almost identically in C++. We add our own
semantic meanings to each keyword, so you should use the appropriate keyword for
the data-type you&#x27;re defining.</p><p>Structs should be used for passive objects that carry data, and may have
associated constants, but lack any functionality other than access/setting the
data members. All fields must be public, and accessed directly rather than
through getter/setter methods. The struct must not have invariants that imply
relationships between different fields, since direct user access to those fields
may break those invariants. Methods should not provide behavior but should only
be used to set up the data members, e.g., constructor, destructor, Initialize(),
Reset().</p><p>If more functionality or invariants are required, a class is more appropriate.
If in doubt, make it a class.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="inheritance"></a>Inheritance<a class="hash-link" href="#inheritance" title="Direct link to heading">#</a></h5><p>Composition is often more appropriate than inheritance. When using inheritance,
make it <code>public</code>.</p><p>All inheritance should be public. If you want to do private inheritance, you
should be including an instance of the base class as a member instead.</p><p>Do not overuse implementation inheritance. Composition is often more
appropriate. Try to restrict the use of inheritance to the &quot;is-a&quot; case: Bar
subclasses Foo if it can reasonably be said that Bar &quot;is a kind of&quot; Foo.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="multiple-inheritance"></a>Multiple Inheritance<a class="hash-link" href="#multiple-inheritance" title="Direct link to heading">#</a></h5><p>Multiple inheritance is especially problematic, because it often imposes a
higher performance overhead (in fact, the performance drop from single
inheritance to multiple inheritance can often be greater than the performance
drop from ordinary to virtual dispatch), and because it risks leading to
&quot;diamond&quot; inheritance patterns, which are prone to ambiguity, confusion, and
outright bugs.</p><p><strong>Multiple implementation inheritance is strongly discouraged.</strong></p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="move"></a>move<a class="hash-link" href="#move" title="Direct link to heading">#</a></h5><p>The <code>std::move</code> introduced in C++11 can effectively transfer resources to other
objects. In our practice, use <code>std :: move</code> can effectively reduce the
consumption of <code>Gas</code>, especially when using containers. When returning a value,
it should return rvalue references and use <code>std::move</code> to convert lvalue
references to rvalue references to reduce Gas consumption. For example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI cpp"><pre tabindex="0" class="prism-code language-cpp codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(199, 146, 234)">::</span><span class="token plain">vector</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(199, 146, 234)">::</span><span class="token plain">string</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">get_vec</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:rgb(199, 146, 234)">::</span><span class="token plain">vector</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(199, 146, 234)">::</span><span class="token plain">string</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// ignore</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:rgb(199, 146, 234)">::</span><span class="token function" style="color:rgb(130, 170, 255)">move</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">v</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// very important</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="auto"></a>auto<a class="hash-link" href="#auto" title="Direct link to heading">#</a></h4><p>The <code>auto</code> keyword can automatically deduced from its initializer. Used with
containers and iterators can simplify code. For example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI cpp"><pre tabindex="0" class="prism-code language-cpp codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(199, 146, 234)">::</span><span class="token plain">map</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(199, 146, 234)">::</span><span class="token plain">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:rgb(199, 146, 234)">::</span><span class="token plain">string</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> my_map</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">auto</span><span class="token plain"> it </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> my_map</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">begin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> it </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> my_map</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">end</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> it</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// ignore</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="reference-arguments"></a>Reference Arguments<a class="hash-link" href="#reference-arguments" title="Direct link to heading">#</a></h5><p>Suggest using reference arguments as function parameters. Reference parameters
can reduce unnecessary replication and reduce unnecessary memory allocation. For us
WASM virtual machines, memory allocation is an expensive operation.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="containers"></a>Containers<a class="hash-link" href="#containers" title="Direct link to heading">#</a></h5><p>The C ++ standard library provides some commonly used containers (map, vector, list, etc.), and you should carefully read the corresponding interface documentation when using it. It is important to note that the <code>operator[]</code> oper ator of map, according to the interface documentation, when the key does not exist, the insert action will be performed. For contract development, when using <code>StorageType</code> to store the map, do not use<code>operator []</code>to determine whether the key exists, but use<code>find ()</code> .</p><hr></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/PlatONnetwork/docs/tree/master/docs/wasm合约开发最佳实践.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_wj+Z"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/Wasm_Contract_Dev_Costs"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Development Costs</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/Wasm_Contract_API"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Wasm API »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link">Introduction</a></li><li><a href="#reasonable-cost-setting" class="table-of-contents__link">Reasonable Cost Setting</a></li><li><a href="#avoid-timeouts" class="table-of-contents__link">Avoid Timeouts</a></li><li><a href="#punishment-for-illegal-operations" class="table-of-contents__link">Punishment For Illegal Operations</a></li><li><a href="#cc-language-limit" class="table-of-contents__link">C/C++ Language Limit</a></li><li><a href="#coding-standards" class="table-of-contents__link">Coding Standards</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><ul class="footer__items"><li class="footer__item"><a href="https://www.platon.network/en" target="_blank" class="footer-logo-home" rel="noreferrer noopener"><img src="/docs/img/PlatON-logo2.svg" width="66" height="58"></a></li></ul></div><div class="col footer__col"><ul class="footer__items"><li class="footer__item"><a href="https://www.platon.network/en" target="_blank" rel="noopener noreferrer" class="footer__link-item" hrefzh="https://www.platon.network/">PlatON network</a></li><li class="footer__item"><a href="https://latticex.foundation/home" target="_blank" rel="noopener noreferrer" class="footer__link-item" hrefzh="https://latticex.foundation/home">LatticeX.Foundation</a></li><li class="footer__item"><a href="https://forum.latticex.foundation/" target="_blank" rel="noopener noreferrer" class="footer__link-item" hrefzh="https://forum.latticex.foundation/">Forum</a></li></ul></div><div class="gitstar"><a class="github-button" href="https://github.com/PlatONnetwork/PlatON-Go" data-color-scheme="no-preference: light; light: light; dark: light;" data-icon="octicon-star" data-size="small" data-show-count="true" aria-label="Star PlatONnetwork/PlatON-Go on GitHub">Star</a></div></div><div class="footer__bottom text--center"><div class="footer__copyright">COPYRIGHT  © 2022 PLATON NETWORK.</div></div></div></footer></div>
<script src="/docs/assets/js/runtime~main.04d2f2cd.js"></script>
<script src="/docs/assets/js/main.16343a54.js"></script>
</body>
</html>